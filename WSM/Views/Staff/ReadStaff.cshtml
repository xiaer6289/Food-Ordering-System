@using WSM.Models
@using X.PagedList
@using X.PagedList.Mvc.Core
@model IPagedList<WSM.Models.Staff>

@{
    ViewBag.Title = "Staff Management";
}

<form method="post" action="/Staff/DeleteMany" id="deleteForm">
    <p>
        <button type="button" class="check-all-btn">Check All</button>
        <button type="button" class="uncheck-all-btn">Uncheck All</button>
    </p>

    <div class="staff-container" id="target">
        <partial name="_ReadStaff" model="Model" />
    </div>
</form>

@section Scripts {
    <script>
        $(document).ready(function () {
            // Check all functionality
            $('.check-all-btn').click(function () {
                $('.staff-checkbox').prop('checked', true);
            });

            // Uncheck all functionality
            $('.uncheck-all-btn').click(function () {
                $('.staff-checkbox').prop('checked', false);
            });

            // Single delete
            $(document).on('click', '.remove-ingredient', function () {
                var button = $(this);
                var id = button.data('id');

                if (confirm('Are you sure you want to delete this staff?')) {
                    $.ajax({
                        url: '/Staff/Delete',
                        type: 'POST',
                        data: { id: id },
                        success: function () {
                            button.closest('tr').fadeOut(300, function () {
                                $(this).remove();
                            });
                        },
                        error: function () {
                            alert('An error occurred while deleting staff.');
                        }
                    });
                }
            });

            // Bulk delete
            $('#deleteForm').submit(function (e) {
                e.preventDefault();
                var checkedBoxes = $('.staff-checkbox:checked');
                if (checkedBoxes.length === 0) {
                    alert('Please select at least one staff to delete.');
                    return false;
                }
                if (!confirm('Are you sure you want to delete the selected staff?')) {
                    return false;
                }

                var form = $(this);
                $.ajax({
                    url: form.attr('action'),
                    type: 'POST',
                    data: form.serialize(),
                    success: function () {
                        checkedBoxes.closest('tr').fadeOut(300, function () {
                            $(this).remove();
                        });
                    },
                    error: function () {
                        alert('An error occurred while deleting.');
                    }
                });
                return false;
            });
        });
    </script>
}
